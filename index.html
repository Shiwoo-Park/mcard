<!DOCTYPE html>
<html lang='ko'>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>강환기 김진숙 결혼합니다.</title>
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/card.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view tde page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="./js/jquery-1.10.1.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script src="./js/bsjs.js"></script>
    <script>
    bs(function(){
      bs.Dom('#puzzle').S('margin','0');

      var game = function(len, size, img) {
        var moving,bx,by,lastswap,blocks,
        checkMovable = function(block) {
          if (block.lx == bx && Math.abs(block.ly - by) == 1) return 1;
          if (block.ly == by && Math.abs(block.lx - bx) == 1) return 1;
          return 0;
        },
        getMovable = function(){
          var movables, block, i;
          i = blocks.length;
          movables = [];
          while (i--) {
            block = blocks[i];
            if (checkMovable(block) && block != lastswap) movables.push(block);
          }
          return movables[bs.rand(0,movables.length-1)];
        },
        swap = function(block) {
          var t0;
          t0 = block.lx;
          block.lx = bx;
          bx = t0;
          t0 = block.ly;
          block.ly = by;
          by = t0;
          lastswap = block;
        },
        motionend = function() {
          moving = 0; 
        },
        motion = function(block) {
          moving = 1;
          bs.ANI.tween( block,'left', block.lx*(size+1), 'top', block.ly*(size+1),'time', 0.5,'ease', 'circleOut', 'end', motionend);
        },
        shuffle = function() {
          for (var i = 0 ; i < 52 ; ++i) swap(getMovable());
        },
        locate = function() {
          var i,block;
          i = blocks.length;
          while (i--) {
            block = blocks[i];
            bs.Dom(block).S('left',block.lx*(size+1),'top',block.ly*(size+1));
          }
        },
        down = function(){
          if (moving) return;
          if (checkMovable(this)) {
            swap(this);
            motion(this);
          }
        },
        hint = function() {
          if (bs.Dom(this).S('text') == '원본보기') {
            bs.Dom("#hint").S('display','block');
            bs.Dom(this).S('text','원본가리기');
          } else {
            bs.Dom("#hint").S('display','none');
            bs.Dom(this).S('text','원본보기');
          }
        },
        init = function(){
          bs.img( function(){
            var i,j,bg;
            bg = ['url('+img+') -',0,'px',' -',0,'px'];
            bs.Css('.block').S('position','absolute','width',size,'height',size);
            bs.Dom('<div id="game"></div>').S('<','#puzzle','position','relative','width',len*(size+1)-1,'height',len*(size+1)-1,'margin','0 auto','background','#eee');

            for ( i = 0; i < len; ++i ) {
              for ( j = 0 ; j < len ; ++j ) {
                bg[1] = j * (size+1), bg[4] = i * (size+1);
                if (i == len-1 && j == len-1) break;
                bs.Dom('<div class="block"></div>').S('<','#game','background',bg.join(''),'@ox',j,'@lx',j,'@oy',i,'@ly',i,'down',down);
              }
            }

            bs.Dom('<div id="hint"></div>').S('<','#game','position','absolute','width','100%','height','100%','background','url('+img+')','display','none');
            bs.Dom('<div id="btn"></div>').S('<','#puzzle','width',len*(size+1)-1,'margin','5px auto','text-align','right');
            bs.Dom('<button class="btn btn-primary"></button>').S('<','#btn','text','원본보기','width',size*3, 'down', hint);

            bx = by = len-1;
            blocks = bs.Dom('.block');
            shuffle();
            locate(); 
          }, img);
        };
        init();
      };
      
      game(3,133,['./img/0', bs.rand(1,9), '_400.jpg'].join(''));
    });
    </script>
  </head>
  <body>
  <div class='container'>
    <div class='row'>
      <div class='col-xs-12'><img class='img-responsive' src='./img/청첩장01.png' /></div>
      <div class='col-xs-10 col-xs-offset-1'>
        <div class='row calendar'>
          <div class='col-xs-2 month'>
            5월
          </div>
          <div class='col-xs-10'>
            <table class='table day'>
              <tr><td>일</td><td>월</td><td>화</td><td>수</td><td>목</td><td>금</td><td>토</td></tr>
              <tr><td></td><td></td><td></td><td></td><td>1</td><td>2</td><td>3</td></tr>
              <tr><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr>
              <tr><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td><td>16</td><td>17</td></tr>
              <tr><td>18</td><td>19</td><td>20</td><td>21</td><td>22</td><td>23</td><td>24</td></tr>
              <tr><td>25</td><td>26</td><td>27</td><td>28</td><td>29</td><td>30</td><td class='d-day'>31</td></tr>
            </table>
          </div>
        </div>
      </div>
      <div class='col-xs-12'><img class='img-responsive' src='./img/청첩장02.png' /></div>
      <div class='col-xs-12'><img class='img-responsive' src='./img/청첩장03.png' /></div>
      <div class='col-xs-12' id='puzzle'>
      </div>
      <div class='col-xs-12'><img class='img-responsive' src='./img/청첩장04.png' /></div>
    </div>
  </div>
  </body>
</html>
